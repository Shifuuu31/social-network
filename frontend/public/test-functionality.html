<!DOCTYPE html>
<html>
<head>
    <title>Groups & Notifications Test</title>
</head>
<body>
    <h1>Groups & Notifications Test</h1>
    <div id="results"></div>
    
    <script>
        const resultsDiv = document.getElementById('results');
        
        function log(message) {
            resultsDiv.innerHTML += `<p>${message}</p>`;
            console.log(message);
        }
        
        async function testFrontendAPI() {
            log('üîç Testing Frontend API Access...');
            
            try {
                // Test groups
                const groupsResponse = await fetch('/api/groups/group/browse', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: "1",
                        start: -1,
                        n_items: 5,
                        type: "user"
                    })
                });
                
                if (groupsResponse.ok) {
                    const groups = await groupsResponse.json();
                    log(`‚úÖ Groups API working: ${groups?.length || 0} groups found`);
                } else {
                    log(`‚ùå Groups API failed: ${groupsResponse.status}`);
                }
                
                // Test notifications
                const notifResponse = await fetch('/api/notifications/unread-count?user_id=1');
                
                if (notifResponse.ok) {
                    const data = await notifResponse.json();
                    log(`‚úÖ Notifications API working: ${data.count || 0} unread`);
                } else {
                    log(`‚ùå Notifications API failed: ${notifResponse.status}`);
                }
                
                // Test WebSocket
                const ws = new WebSocket('ws://localhost:5173/connect');
                
                ws.onopen = () => {
                    log('‚úÖ WebSocket connection successful');
                    ws.close();
                };
                
                ws.onerror = () => {
                    log('‚ùå WebSocket connection failed');
                };
                
                setTimeout(() => {
                    if (ws.readyState !== WebSocket.OPEN) {
                        log('‚ö†Ô∏è WebSocket connection timeout');
                    }
                }, 3000);
                
            } catch (error) {
                log(`‚ùå Test error: ${error.message}`);
            }
        }
        
        // Run test when page loads
        testFrontendAPI();
    </script>
</body>
</html>
